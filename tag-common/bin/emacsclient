#!/usr/bin/env ruby

require 'pathname'
require 'socket'

emacsclient = "/usr/local/bin/emacsclient"
emacs_socket = "/home/jereme/.ssh/emacs-server"

if (ENV.has_key?("SSH_CLIENT"))
  file = Pathname.new(Dir.pwd) + ARGV.pop()
  args = ["-s", emacs_socket, *ARGV, "/scp:#{Socket.gethostname}:#{file.cleanpath}"]
else
  args = ARGV
end

system(emacsclient, *args) or
  raise "failed to run emacsclient"
